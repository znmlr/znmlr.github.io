---
title: "02 Verilog HDL基础知识"
date: 2022-11-02T23:19:19+08:00
draft: false
weight: 2
---

## Verilog HDL语言要素

### 空白符

- 包括空格符`\b`、制表符`\t`、换行符和换页符
- 在编译和综合时，会被忽略
- `Verilog HDL`程序可以不分行，也可以分多行

```verilog
initial begin a = 3'b100; b = 3'b010; end

// 相当于
initial
    begin
        a = 3'b100;
        b = 3'b010;
    end
```

### 注释符

- 单行注释：以`//`开始
- 多行注释：以`/*`开始，以`*/`结束。多行注释不允许嵌套，单行注释可以嵌套在多行注释中

```verilog
/* 非法注释/*非法注释*/非法注释*/

/*合法注释//合法注释*/
```

### 标识符

- 任意一组字母、数字、`$`符合和`_`下划线符合的组合。且第一个字符必须是字母或者下划线
- 字母区分大小写

### 关键字

- 关键字都是小写的

 ![image-20221104211804754](https://nas.znmlr.cn:15900/markdown/2022/11/image-20221104202713546.png)

### 数值

- Verilog HDL有四种基本的逻辑数值状态

 ![image-20221104203730108](https://nas.znmlr.cn:15900/markdown/2022/11/image-20221104203730108.png)

#### 整数及其表示

 ![image-20221104212201186](https://nas.znmlr.cn:15900/markdown/2022/11/image-20221104212201186.png)

​	`+/-<size>'<base_format><number>`

- size：换算后的二进制宽度，没有说明位宽时默认为32位
- `x`或者`z`出现在二进制中代表1位`x`或`z`，在八进制中代表3位，在十六进制中代表4位
- 位宽不能有表达式
- 数字部分不能有空格
- 数值部分不能有负号，需要写最前面 
- `?`与`z`是等价的

#### 实数及其表示

- 实数有两种表示法：十进制表示法、科学计数法
- 实数转整数，用四舍五入，而不是向下取整

### 字符串及其表示

- 双引号括起来的字符序列
- 必须在同一行中，不能分行

## 数据类型

### 物理数据类型

- 主要包括连线型、寄存器和存储器类型
- 抽象程度比较低，与实际硬件电路的映射关系比较明显
- 使用四值逻辑和八种信号强度对应实际的硬件电路建模

 ![image-20221105112137062](https://nas.znmlr.cn:15900/markdown/2022/11/image-20221105112137062.png)

#### 连线型

 ![image-20221105112710626](https://nas.znmlr.cn:15900/markdown/2022/11/image-20221105112710626.png)

- `wire`与`tri`

 ![image-20221105113022862](https://nas.znmlr.cn:15900/markdown/2022/11/image-20221105113022862.png)

- `wor`与`trior`

 ![image-20221105113107597](https://nas.znmlr.cn:15900/markdown/2022/11/image-20221105113107597.png)

#### 寄存器型

- `reg`型变量是数据存储单元的抽象类型，其对应的硬件电路元件具有状态保持的作用，能够存储数据，如触发器、锁存器等。
- `reg`型变量常用于行为级描述中，由过程赋值语句对其进行赋值。

- `reg`与`wire`的区别在于：`reg`型数据保持最后一次的赋值，而`wire`型数据需要有持续的驱动。
- `reg`型数据的默认初始值为`x`，缺省位宽为1位

#### 存储器型

- 可以描述`RAM`型、`ROM`型及`reg`文件
- 本质还是寄存器型变量，用`reg`型变量建立寄存器数组来实现存储器的功能

### 抽象数据类型

- 整型`interger`、时间型`time`、实型`real`、参数型`parameter`
- 时间型数据与整型类似，它是64位无符号数，用于对模拟时间的存储与计算处理，常与系统函数`$time`一起使用
- 对于同一个模块而言，参数一旦定义就不能通过别的语句重新赋值

## 运算符

 ![image-20221105115159299](https://nas.znmlr.cn:15900/markdown/2022/11/image-20221105115159299.png)

### 算术运算符

- `+`、`-`、`*`、`/`、`%`

- 算术运算表达式结果的位宽由最长的操作数决定
- 在赋值语句中，算术运算结果的长度由左值长度决定
- 有符号数值一般存储在整型变量、十进制形式的整数；无符号数值一般存在在线网、`reg`型变量等

### 关系运算符

- 大于、小于、大于等于、小于等于
- 成立则返回`1'b1`，不成立则返回`1'b0`，不确定则返回`x`

### 相等关系运算符

- 等于、不等于、全等非全等
- `==`和`!=`称为逻辑等式运算符，其结果由两个操作数的值决定，不比较位宽
- `===`和`!==`是对操作数进行按位比较，必须完全一致其结果为`1`，否则为`0`，不会有`x`

 ![image-20221106104550463](https://nas.znmlr.cn:15900/markdown/2022/11/image-20221106104550463.png)

 ![image-20221106104605044](https://nas.znmlr.cn:15900/markdown/2022/11/image-20221106104605044.png)

### 逻辑运算符

- 逻辑与、逻辑或、逻辑非，前2者为双目运算符，后者是单目运算符
- 操作数只能是逻辑`1`或逻辑`0`

 ![image-20221106105457647](https://nas.znmlr.cn:15900/markdown/2022/11/image-20221106105457647.png)

### 按位运算符

- 按位取反`~`、按位与`&`、按位或`|`、按位异或`^`、按位同或`^~`
- 按位运算符是对其自变量的每一位进行操作

 ![image-20221106110049279](https://nas.znmlr.cn:15900/markdown/2022/11/image-20221106110049279.png)

 ![image-20221106110124716](https://nas.znmlr.cn:15900/markdown/2022/11/image-20221106110124716.png) 

- 两个不同长度的数据进行位运算时，会自动将右端对其，位数少的会在高位补`0`对齐。运算结果的位宽与操作数中位宽较大者相同

### 规约运算符

- 按位进行逻辑运算，属于单目运算符，运算结果是1位逻辑值
- `&`、`|`、`^`、`~&`、`~|`、`~^`

### 移位运算符

- 左移运算符`<<`、右移运算符`>>`，用0补移出的空位

### 条件运算符

- 三目运算符
- 条件表达式为`1`，执行表达式`1`；条件表达式为`0`，执行表达`2`
- 条件表达式为`x`，则将按位对表达式1和表达式2的值进行比较，从而构成整体的结果值

 ![image-20221106111012172](https://nas.znmlr.cn:15900/markdown/2022/11/image-20221106111012172.png)

 ![image-20221106111048326](https://nas.znmlr.cn:15900/markdown/2022/11/image-20221106111048326.png)

### 连接和复制运算符

- 连接运算符`{}`：把位于大括号中的两个或两个以上信号或小表达式(用逗号隔开)，最后用大括号表示一个整体信号，形成一个大的表达式
- 复制运算符`{{}}`：将一个表达式放入双花括号内，复制因子放第一层括号中，表示重复几次

## 模块

### 基本概念

- 模块`module`是`Verilog HDL`的基本单元，代表一个基本的功能块，用于描述某个设计的功能或结构以及与其它模块通信的外部端口

 ![image-20221106111617539](https://nas.znmlr.cn:15900/markdown/2022/11/image-20221106111617539.png)

模块主要包括以下几个基本部分：

- 模块的开始与结束。开始部分包括模块名和端口列表。模块名是模块的唯一性标志符，端口列表是由模块各个输入、输出和双向端口变量组成的一个列表
- 模块端口定义：定义端口列表里的变量哪些是输入、输出和双向端口及位宽
- 模块数据类型说明：包括`wire`、`reg`、`parameer`等数据类型，及说明模块中所用到的内部信号、调用模块等的声明语句和功能定义语句。一般来说，`input`缺省为`wire`类型，`output`可以是`wire`也可以是`reg`类型，`inout`一般是`tri`类型
- 模块逻辑功能描述：产生各种逻辑，主要是组合逻辑和时序逻辑，主要包括`initial`语句、`always`语句、其它子模块实例化语句、门实例化语句、用户自定义原语`UDP`实例化语句、连续赋值语句`assign`、函数`function`和任务`task`

 ![image-20221106112341916](https://nas.znmlr.cn:15900/markdown/2022/11/image-20221106112341916.png) 
 ![image-20221106112424638](https://nas.znmlr.cn:15900/markdown/2022/11/image-20221106112424638.png)

### 端口

- 模块的端口可以是输入端口`input`、输出端口`output`、双向端口`inout`
- 
